getfenv().AutoRace = false
getfenv().AutoSmashSnow = false
getfenv().AutoBronzeCup = false
local RaceMode = "Remote"
local Race = "None"
local FarmSpeed = 250
local selectedPlayer = nil
local lowGraphicsEnabled = false
local job_id = nil

local RunService = game:GetService("RunService")
local player = game:GetService("Players").LocalPlayer
local char = player.Character
local ts, TeleportService = game:GetService("TeleportService"), game:GetService("TeleportService")
local gui = player.PlayerGui:WaitForChild("Races")

local Platform = Instance.new("Part")
Platform.Name = "AutoRacePlatform"
Platform.Size = Vector3.new(60, 2, 60)
Platform.Anchored = true
Platform.CanCollide = true
Platform.Transparency = 0.5
Platform.Material = Enum.Material.SmoothPlastic
Platform.Parent = workspace

local RacesQueueData = {
    "Air Race N/A",
    "Around The Map N/A",
    "Beach Dash N/A",
    "Boat Race N/A",
    "Circuit Moto Race N/A",
    "Circuit Race N/A",
    "Desert Race N/A",
    "Drag Race N/A",
    "Highway Race N/A",
    "Miami City Circuit N/A",
    "Mountain Dash N/A",
    "Offroad Race N/A",
    "Tropical Dash N/A",
    "Karting Race N/A",
    "Frozen Lake N/A"
}

local function getChar()
    return player.Character or player.CharacterAdded:Wait()
end

local function getHum()
    return char:WaitForChild("Humanoid")
end

local function getRoot()
    return char:WaitForChild("HumanoidRootPart")
end

local function GetCar()
    return workspace:FindFirstChild("Vehicles"):FindFirstChild(player.Name.."'s Car")
end

local function plrList()
    local players = {}
    for _, p in ipairs(game.Players:GetPlayers()) do
        if p ~= player then
            table.insert(players, p.Name)
        end
    end
    return players
end

local function RemoveCarWheelForces(car)
    if not car or not car.PrimaryPart then return end
    for _, v in pairs(car:FindFirstChild("Wheels"):GetChildren()) do
        if v:IsA("Part") then
            v.AssemblyLinearVelocity = Vector3.zero
            v.AssemblyAngularVelocity = Vector3.zero
        end
    end
end

function RunLowGraphics()
    local Lighting = game:GetService("Lighting")
    local terrain = workspace:FindFirstChildOfClass("Terrain")
    lowGraphicsEnabled = true

    Lighting.GlobalShadows = false
    Lighting.EnvironmentDiffuseScale = 0
    Lighting.EnvironmentSpecularScale = 0
    Lighting.Brightness = 1

    for _, effect in ipairs(Lighting:GetChildren()) do
        if effect:IsA("PostEffect") then
            effect.Enabled = false
        end
    end

    task.wait(1)

    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Decal") or obj:IsA("Texture") or obj:IsA("SurfaceAppearance") then
            obj:Destroy()
        elseif obj:IsA("Beam") or obj:IsA("Trail") then
            obj:Destroy()
        end
    end

    for _, part in ipairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") then
            part.Material = Enum.Material.SmoothPlastic
            part.Reflectance = 0

            if part:IsA("MeshPart") then
                part.TextureID = ""
                part.Color = Color3.new(1,1,1)
            end
        end
    end

    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("ParticleEmitter") or obj:IsA("Fire") or obj:IsA("Smoke") or obj:IsA("Sparkles") then
            obj.Enabled = false
            if obj:IsA("ParticleEmitter") then
                obj.Rate = 0
            end
        end
    end

    if terrain then
        terrain.WaterWaveSize = 0
        terrain.WaterWaveSpeed = 0
        terrain.WaterTransparency = 1
        terrain.WaterReflectance = 0
        warn("Terrain water disabled.")
    else
        warn("Terrain not found.")
    end

for _, obj in ipairs(workspace:GetDescendants()) do
    if obj:IsA("Humanoid") and obj.Parent then
        obj.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None
    end

    if (obj:IsA("ShirtGraphic") or obj:IsA("Shirt") or obj:IsA("Pants")) and obj.Parent then
        obj:Destroy()
    end

    if obj:IsA("MeshPart") and obj.Parent and obj.Parent:FindFirstChild("Humanoid") then
        obj.TextureID = ""
    end
end
end

local function MoveCFrameLinear(part, target, speed, onComplete)
    if not part or not part.Parent then return end
    if part:GetAttribute("Moving") then return end

    part:SetAttribute("Moving", true)
    speed = speed or 250

    local startCF = part.CFrame
    local startPos = startCF.Position
    local endPos = target.Position

    local distance = (endPos - startPos).Magnitude
    local duration = distance / speed
    if duration < 0.001 then
        part.AssemblyLinearVelocity = Vector3.zero
        part.AssemblyAngularVelocity = Vector3.zero
        part.CFrame = CFrame.new(endPos) * target.Rotation
        part:SetAttribute("Moving", false)
        if onComplete then onComplete() end
        return
    end

    local startTime = tick()
    local conn
    conn = RunService.Heartbeat:Connect(function()
        if not part.Parent then
            conn:Disconnect()
            return
        end

        local t = math.clamp((tick() - startTime) / duration, 0, 1)

        local newPos = startPos:Lerp(endPos, t)
        local newCF = startCF:Lerp(target, t)

        local car = GetCar()

        RemoveCarWheelForces(car)
        part.AssemblyLinearVelocity = Vector3.zero
        part.AssemblyAngularVelocity = Vector3.zero
        part.CFrame = CFrame.new(newPos) * newCF.Rotation

        if t >= 1 then
            conn:Disconnect()
            part:SetAttribute("Moving", false)
            if onComplete then onComplete() end
        end
    end)
end

function getRacesList()
    local Races = {}
    for _, v in pairs(workspace.Races:GetChildren()) do
        if v:IsA("Folder") then
            table.insert(Races, v.Name)
        end
    end
    return Races
end

local function RunCircuitRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(-4754, 5, -1583))
    end)

    task.wait(55)

    for i = 1, 56 do
        local args = { ((i - 1) % 28) + 1, "Circuit Race" }
        game.ReplicatedStorage.Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunMountainDashRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(3308, 7, -2309))
    end)

    task.wait(43)

    for i = 1, 32 do
        local args = { i, "Mountain Dash" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunAroundTheMapRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(3504, 61, 2070))
    end)

    task.wait(30)

    for i = 1, 34 do
        local args = { i, "Around The Map" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunBeachDashRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(-4941, 5, 1192))
    end)

    task.wait(10)

    for i = 1, 6 do
        local args = { i, "Beach Dash" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunDesertRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(-4941, 5, 1192))
    end)

    task.wait(13)

    for i = 1, 10 do
        local args = { i, "Desert Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunDragRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(-3225, 5, -2733))
    end)

    task.wait(4.8)

        local args = { 1, "Drag Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
end

local function RunHighwayRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(2911, 67, -11961))
    end)

    task.wait(19)

    for i = 1, 30 do
        local args = { i, "Highway Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunAroundTheMapRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(3504, 61, 2070))
    end)

    task.wait(30)

    for i = 1, 34 do
        local args = { i, "Around The Map" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunTropicalDashRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(2992, -7, -4620))
    end)

    task.wait(5)

    for i = 1, 8 do
        local args = { i, "Tropical Dash" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunOffroadRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(1913, 4, 3379))
    end)

    task.wait(15)

    for i = 1, 11 do
        local args = { i, "Offroad Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunMiamiCityCircuitRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(1311, 5, -1628))
    end)

    task.wait(57)

    for i = 1, 38 do
        local args = { i, "Miami City Circuit" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunCircuitMotoRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(1075, 8, 4190))
    end)

    task.wait(60)

    for i = 1, 42 do
        local args = { i, "Circuit Moto Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunKartingRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(1811, 6, 4480))
    end)

    task.wait(45)

    for i = 1, 30 do
        local args = { i, "Karting Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunAirRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(4946, 12, -3327))
    end)

    task.wait(13)

    for i = 1, 20 do
        local args = { i, "Air Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunBoatRaceRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(-1220, -6, -4789))
    end)

    task.wait(15)

    for i = 1, 8 do
        local args = { i, "Boat Race" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function RunFrozenLakeRemote(car)
    if not car or not car:FindFirstChild("VehicleSeat") then return end

    pcall(function()
        car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
        car:PivotTo(CFrame.new(2420, -6, 1785))
    end)

    task.wait(70)

    for i = 1, 24 do
        local args = { i, "Frozen Lake" }
        game:GetService("ReplicatedStorage").Event.Races.Check:FireServer(unpack(args))
    end
end

local function LinearRaces(car, RaceName)
    if not car then return end

    local root = car.PrimaryPart or car:FindFirstChild("VehicleSeat")
    if not root then return end

    for lap = 1, 2 do
        if not RaceName:GetAttribute("RaceActive") then return end

        local checkpointsFolder = workspace.RaceProps:FindFirstChild("Checkpoints")
        if not checkpointsFolder then return end

        local checkpoints = checkpointsFolder:GetChildren()
        table.sort(checkpoints, function(a, b)
            return tonumber(a.Name) < tonumber(b.Name)
        end)

        for _, checkpoint in ipairs(checkpoints) do
            if not RaceName:GetAttribute("RaceActive") then return end

            local display = checkpoint:FindFirstChild("Display")
            local model = display and display:FindFirstChildOfClass("Model")
            local border = model and model:FindFirstChild("Border")
            if not border then continue end

            local targetCF = border.CFrame * CFrame.new(0, 3.5, 0)

            local reached = false
            MoveCFrameLinear(root, targetCF, FarmSpeed, function()
                reached = true
                RemoveCarWheelForces(car)
            end)

            repeat
                task.wait()
            until reached or not RaceName:GetAttribute("RaceActive")

            if not RaceName:GetAttribute("RaceActive") then
                return
            end
        end
    end
end


local Library = loadstring(game:HttpGetAsync("https://github.com/ActualMasterOogway/Fluent-Renewed/releases/latest/download/Fluent.luau"))()
local SaveManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/SaveManager.luau"))()
local InterfaceManager = loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/ActualMasterOogway/Fluent-Renewed/master/Addons/InterfaceManager.luau"))()
 
local Window = Library:CreateWindow{
    Title = "[ðŸ™ï¸Map!] Vehicle Legends ðŸŽï¸ Cars!",
    SubTitle = "by DmaxDAZ",
    TabWidth = 160,
    Size = UDim2.fromOffset(830, 525),
    Resize = true,
    MinSize = Vector2.new(520, 380),
    Acrylic = false,
    Theme = "Vynixu",
    MinimizeKey = Enum.KeyCode.K
}

local Tabs = {
    Main = Window:CreateTab{
        Title = "Main",
        Icon = "house"
    },
    Players = Window:CreateTab{
        Title = "Player",
        Icon = "users"
    },
    Status = Window:CreateTab{
        Title = "Status",
        Icon = "scroll-text"
    },
    Misc = Window:CreateTab{
        Title = "Misc",
        Icon = "microchip"
    }
}

local Options = Library.Options

local mod = Tabs.Main:CreateDropdown("mode", {
    Title = "Select Farm Mode",
    Values = {"Remote", "Tween"},
    Multi = false,
    Default = 1,
})

mod:OnChanged(function(Value)
    RaceMode = Value
end)

local race = Tabs.Main:CreateDropdown("RaceSelect", {
    Title = "Select Race",
    Values = getRacesList(),
    Multi = false,
    Default = 1,
})

race:OnChanged(function(Value)
    Race = Value
end)

local tgFa = Tabs.Main:CreateToggle("TGFARM", {Title = "Toggle Auto Race", Default = false })

tgFa:OnChanged(function(bool)
    getfenv().AutoRace = bool
end)

local tgSn = Tabs.Main:CreateToggle("TGSNOW", {Title = "Toggle Auto Snow Smash", Default = false })

tgSn:OnChanged(function(bool)
    getfenv().AutoSmashSnow = bool
end)

local tgbc = Tabs.Main:CreateToggle("TGBRONZECUP", {Title = "Toggle Auto Find Bronze Cup", Default = false })

tgbc:OnChanged(function(bool)
    getfenv().AutoBronzeCup = bool
end)

Tabs.Main:CreateButton{
    Title = "Teleport to your vehicle",
    Callback = function()
    local car = GetCar()
        if car then
            local weight = car:FindFirstChild("Weight") or car.PrimaryPart
            if weight then
                local root = getRoot()
                root.CFrame = weight.CFrame
            else
                Library:Notify({
                    Title = "Info",
                    Content = "Fail to teleport: Vehicle has no Weight or PrimaryPart.",
                    Duration = 8
                })
            end
        else
            Library:Notify({
                Title = "Info",
                Content = "Fail to teleport: Your vehicle is missing.",
                Duration = 8
            })
        end
    end
}

local Target = Tabs.Players:AddDropdown("TargetPlayer", {
    Title = "Select player",
    Values = plrList(),
    Multi = false,
    Default = "None",
})

Target:OnChanged(function(Value)
    selectedPlayer = Value
    warn(selectedPlayer)
end)

Tabs.Players:AddButton({
    Title = "Refresh players",
    Callback = function()
        local updatedPlayers = plrList()

        if Target.SetValues then
            Target:SetValues(updatedPlayers)
        else
            Target.Values = updatedPlayers
        end

        Library:Notify({
            Title = "Info",
            Content = "Update successfully.",
            Duration = 5
        })
    end
})

local TeleportConnection

local TP = Tabs.Players:CreateToggle("TeleportPlr", {Title = "Teleport to selected player", Default = false })

TP:OnChanged(function(enabled)
local car = GetCar()
    if enabled then
        
        TeleportConnection = RunService.Heartbeat:Connect(function()

            local char = getChar()
            local root = getRoot()

            local targetPlayer = game.Players:FindFirstChild(selectedPlayer)
            if not targetPlayer then return end

            local targetHRP = targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart")
            if not targetHRP then return end

            local targetCFrame = targetHRP.CFrame

            if not char.Humanoid.Sit then
                root.AssemblyLinearVelocity = Vector3.new(0,1,0)
                root.CFrame = targetCFrame --root.CFrame:Lerp(targetCFrame, 0.1)
            end

            if char.Humanoid.Sit and car then

                local seat = car:FindFirstChild("VehicleSeat")
                if not seat then return end

                seat.AssemblyLinearVelocity = Vector3.new(0,0.1,0)

                local newCF = targetCFrame--car.PrimaryPart.CFrame:Lerp(targetCFrame, 0.1)

                car:PivotTo(newCF)
            end
        end)

    else
        if TeleportConnection then
            TeleportConnection:Disconnect()
            TeleportConnection = nil
        end
    end
end)

local view = Tabs.Players:AddToggle("Viewing", {Title = "Spectate selected player", Default = false })

view:OnChanged(function(bool)
    getfenv().spectate = bool
        if selectedPlayer then
            local targetPlayer = game.Players:FindFirstChild(selectedPlayer)
            if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local myCharacter = getChar()
                if myCharacter and myCharacter:FindFirstChild("HumanoidRootPart") then
                 if bool then
                    spawn(function()
                        while getfenv().spectate do
                            RunService.Heartbeat:Wait()
                             Workspace.Camera.CameraSubject = targetPlayer.Character.Humanoid
                        end
                    end)
                 else
                    Workspace.Camera.CameraSubject = myCharacter.Humanoid
                 end
            end
        end
    end
end)

local stats = Tabs.Status:CreateParagraph("Aligned Paragraph", {
    Title = "Races In-Progress Status",
    Content = table.concat(RacesQueueData, "\n"),
    TitleAlignment = "Middle",
    ContentAlignment = Enum.TextXAlignment.Center
})

spawn(function()
    RunService.Heartbeat:Connect(function()
        local RaceFolder = workspace:FindFirstChild("Races")
        if RaceFolder then
        RacesQueueData[1] = RaceFolder:FindFirstChild("Air Race"):GetAttribute("RaceActive") and "Air Race  ðŸŸ¢" or "Air Race  ðŸ”´"
        RacesQueueData[2] = RaceFolder:FindFirstChild("Around The Map"):GetAttribute("RaceActive") and "Around The Map  ðŸŸ¢" or "Around The Map  ðŸ”´"
        RacesQueueData[3] = RaceFolder:FindFirstChild("Beach Dash"):GetAttribute("RaceActive") and "Beach Dash  ðŸŸ¢" or "Beach Dash  ðŸ”´"
        RacesQueueData[4] = RaceFolder:FindFirstChild("Boat Race"):GetAttribute("RaceActive") and "Boat Race  ðŸŸ¢" or "Boat Race  ðŸ”´"
        RacesQueueData[5] = RaceFolder:FindFirstChild("Circuit Moto Race"):GetAttribute("RaceActive") and "Circuit Moto Race  ðŸŸ¢" or "Circuit Moto Race  ðŸ”´"
        RacesQueueData[6] = RaceFolder:FindFirstChild("Circuit Race"):GetAttribute("RaceActive") and "Circuit Race  ðŸŸ¢" or "Circuit Race  ðŸ”´"
        RacesQueueData[7] = RaceFolder:FindFirstChild("Desert Race"):GetAttribute("RaceActive") and "Desert Race  ðŸŸ¢" or "Desert Race  ðŸ”´"
        RacesQueueData[8] = RaceFolder:FindFirstChild("Drag Race"):GetAttribute("RaceActive") and "Drag Race  ðŸŸ¢" or "Drag Race  ðŸ”´"
        RacesQueueData[9] = RaceFolder:FindFirstChild("Highway Race"):GetAttribute("RaceActive") and "Highway Race  ðŸŸ¢" or "Highway Race  ðŸ”´"
        RacesQueueData[10] = RaceFolder:FindFirstChild("Miami City Circuit"):GetAttribute("RaceActive") and "Miami City Circuit ðŸŸ¢" or "Miami City Circuit  ðŸ”´"
        RacesQueueData[11] = RaceFolder:FindFirstChild("Mountain Dash"):GetAttribute("RaceActive") and "Mountain Dash  ðŸŸ¢" or "Mountain Dash  ðŸ”´"
        RacesQueueData[12] = RaceFolder:FindFirstChild("Offroad Race"):GetAttribute("RaceActive") and "Offroad Race  ðŸŸ¢" or "Offroad Race  ðŸ”´"
        RacesQueueData[13] = RaceFolder:FindFirstChild("Tropical Dash"):GetAttribute("RaceActive") and "Tropical Dash  ðŸŸ¢" or "Tropical Dash  ðŸ”´"
        RacesQueueData[14] = RaceFolder:FindFirstChild("Karting Race"):GetAttribute("RaceActive") and "Karting Race  ðŸŸ¢" or "Karting Race  ðŸ”´"
        RacesQueueData[15] = RaceFolder:FindFirstChild("Frozen Lake"):GetAttribute("RaceActive") and "Frozen Lake  ðŸŸ¢" or "Frozen Lake  ðŸ”´"
        stats:SetValue(table.concat(RacesQueueData, "\n"))
        end
    end)
end)

Tabs.Misc:AddButton({
    Title = "Low Graphic Mode",
    Callback = function()
        Window:Dialog({
            Title = "Warning",
            Content = "Run low graphics?",
            Buttons = {
                {
                    Title = "Continue",
                    Callback = function()
                        if lowGraphicsEnabled then
                            Window:Dialog({
                                Title = "Warning",
                                Content = "Low Graphics Mode has already been applied. Running it again may reduce FPS instead of boosting it. Continue?",
                                Buttons = {
                                    {
                                        Title = "Continue",
                                        Callback = function()
                                            RunLowGraphics()
                                        end
                                    },
                                    {
                                        Title = "Cancel",
                                        Callback = function()
                                            warn("User canceled")
                                        end
                                    }
                                }
                            })
                        else
                            RunLowGraphics()
                        end
                    end
                },
                {
                    Title = "Cancel",
                    Callback = function()
                        warn("User canceled")
                    end
                }
            }
        })
    end
})


Tabs.Misc:AddButton({
    Title = "Rejoin Server",
    Callback = function()
    Window:Dialog({
            Title = "Warning",
            Content = "Are you sure you want to rejoin this server?",
            Buttons = {
                {
                    Title = "Continue",
                    Callback = function()
                        ts:TeleportToPlaceInstance(game.PlaceId, game.JobId, user)
                    end
                },
                {
                    Title = "Cancel",
                    Callback = function()
                        warn("Cancel")
                    end
                }
            }
        })
    end
})

Tabs.Misc:AddButton({
        Title = "Copy JobId",
        Callback = function()
        setclipboard(game.JobId)
        Library:Notify({
        Title = "Info",
        Content = "Copied.",
        Duration = 3.5
        })
    end
})

local Jobid = Tabs.Misc:AddInput("Input", {
        Title = "Enter JobId",
        Placeholder = "Enter your jobid here.",
        Numeric = false,
        Finished = false,
        Callback = function(Value)
            job_id = Value
            warn(job_id)
        end
    })

Tabs.Misc:AddButton({
    Title = "Join JobId",
    Callback = function()

        if not job_id or job_id == "" then
            Library:Notify({
                Title = "Info",
                Content = "Did you forget to add JobId?",
                Duration = 5
            })
            return
        end

        local teleportFailed = false
        
        local connection
        connection = TeleportService.TeleportInitFailed:Connect(function(_, _, _)
            teleportFailed = true

            Library:Notify({
                Title = "Teleport Failed",
                Content = "Server not found or invalid JobId.",
                Duration = 6
            })

            if connection then
                connection:Disconnect()
                connection = nil
            end
        end)

        Window:Dialog({
                Title = "Warning",
                Content = "Are you sure you want to join this JobId?",
                Buttons = {
                    {
                        Title = "Continue",
                        Callback = function()
                            TeleportService:TeleportToPlaceInstance(game.PlaceId, job_id, player)
                        end
                    },
                    {
                        Title = "Cancel",
                        Callback = function()
                            warn("Cancel")
                        end
                    }
                }
            })
        
        task.wait(0.5)

        if teleportFailed then
            return
        end

    end
})

local Racing = false

task.spawn(function()
    while true do
        task.wait()

        if not getfenv().AutoRace then continue end
        if Racing then continue end

        local car = GetCar()
        if not car then continue end
        car.PrimaryPart = car.PrimaryPart or car:FindFirstChild("VehicleSeat")
        if not car.PrimaryPart then continue end

        if Race == "Circuit Race" then

        local circuitRace = workspace.Races:WaitForChild("Circuit Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and circuitRace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunCircuitRemote(car)
            else
                LinearRaces(car, circuitRace)
            end

            Racing = false
        end

        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(723, 6, -1818)) > 15 and not circuitRace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(723, 6, -1818))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Mountain Dash" then

        local mountaindash = workspace.Races:WaitForChild("Mountain Dash")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and mountaindash:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunCircuitRemote(car)
            else
                LinearRaces(car, mountaindash)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(600, 5, -1389)) > 15 and not mountaindash:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(600, 5, -1389))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Around The Map" then

        local aruoundthemap = workspace.Races:WaitForChild("Around The Map")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and aruoundthemap:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunAroundTheMapRemote(car)
            else
                LinearRaces(car, aruoundthemap)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(740, 5, -1379)) > 15 and not aruoundthemap:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(740, 5, -1379))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Beach Dash" then

        local beachdash = workspace.Races:WaitForChild("Beach Dash")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and beachdash:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunBeachDashRemote(car)
            else
                LinearRaces(car, beachdash)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(716, 5, -1929)) > 15 and not beachdash:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(716, 5, -1929))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Desert Race" then

        local desertrace = workspace.Races:WaitForChild("Desert Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and desertrace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunDesertRaceRemote(car)
            else
                LinearRaces(car, desertrace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(724, 5, -1727)) > 15 and not desertrace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(724, 5, -1727))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Drag Race" then

        local dragrace = workspace.Races:WaitForChild("Drag Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and dragrace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunDragRaceRemote(car)
            else
                LinearRaces(car, dragrace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(572, 5, -1898)) > 15 and not dragrace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(572, 5, -1898))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Highway Race" then

        local highway = workspace.Races:WaitForChild("Highway Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and highway:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunDesertRaceRemote(car)
            else
                LinearRaces(car, highway)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(581, 8, -1815)) > 15 and not highway:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(581, 8, -1815))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Miami City Circuit" then

        local miamicitycircuit = workspace.Races:WaitForChild("Miami City Circuit")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and miamicitycircuit:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunMiamiCityCircuitRemote(car)
            else
                LinearRaces(car, miamicitycircuit)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(746, 7, -1514)) > 15 and not miamicitycircuit:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(746, 7, -1514))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Tropical Dash" then

        local tropicaldash = workspace.Races:WaitForChild("Tropical Dash")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and tropicaldash:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunTropicalDashRemote(car)
            else
                LinearRaces(car, tropicaldash)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(584, 7, -1715)) > 15 and not tropicaldash:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(584, 7, -1715))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Offroad Race" then

        local offroadrace = workspace.Races:WaitForChild("Offroad Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and offroadrace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunOffroadRaceRemote(car)
            else
                LinearRaces(car, offroadrace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(586, 7, -1499)) > 15 and not offroadrace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(586, 7, -1499))
                    task.wait()
                    end
                end)
            end
        end

        elseif Race == "Circuit Moto Race" then

        local circuitmotorace = workspace.Races:WaitForChild("Circuit Moto Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and circuitmotorace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunCircuitMotoRaceRemote(car)
            else
                LinearRaces(car, circuitmotorace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(564, 7, -1991)) > 15 and not circuitmotorace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(564, 7, -1991))
                    task.wait()
                    end
                end)
            end
        end  
        
        elseif Race == "Karting Race" then

        local kartingrace = workspace.Races:WaitForChild("Karting Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and kartingrace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunKartingRaceRemote(car)
            else
                LinearRaces(car, kartingrace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(720, 7, -2007)) > 15 and not kartingrace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(720, 7, -2007))
                    task.wait()
                    end
                end)
            end
        end    
        
        elseif Race == "Air Race" then

        local airrace = workspace.Races:WaitForChild("Air Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and airrace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunAirRaceRemote(car)
            else
                LinearRaces(car, airrace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(3897, 9, -3065)) > 15 and not airrace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(3897, 9, -3065))
                    task.wait()
                    end
                end)
            end
        end     
        
        elseif Race == "Boat Race" then

        local boatrace = workspace.Races:WaitForChild("Boat Race")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and boatrace:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunBoatRaceRemote(car)
            else
                LinearRaces(car, boatrace)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(184, -6, -1120)) > 15 and not boatrace:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(184, -6, -1120))
                    task.wait()
                    end
                end)
            end
        end    
        
        elseif Race == "Frozen Lake" then

        local frozenlake = workspace.Races:WaitForChild("Frozen Lake")
        local timer = gui:WaitForChild("Timer")

        if timer.Visible
            and tonumber(timer.Text) == 1
            and frozenlake:GetAttribute("RaceActive")
        then
            Racing = true
            task.wait(1)

            if RaceMode == "Remote" then
                RunFrozenLakeRemote(car)
            else
                LinearRaces(car, frozenlake)
            end

            Racing = false
        end
        if not timer.Visible then
            if player:DistanceFromCharacter(Vector3.new(550, 7, -1057)) > 15 and not frozenlake:GetAttribute("RaceActive") then
                pcall(function()
                    for i = 1,5 do
                    car.VehicleSeat.AssemblyLinearVelocity = Vector3.zero
                    car:PivotTo(CFrame.new(550, 7, -1057))
                    task.wait()
                    end
                end)
            end
        end         

     end
    end
end)

task.spawn(function()
    while true do
        task.wait()

        if not getfenv().AutoSmashSnow then
            continue
        end

        local snowFolder = workspace:FindFirstChild("BreakableSnowmens")
        if not snowFolder then
            continue
        end

        local car = GetCar()
        local hum = getHum()
        if not car or not car.PrimaryPart and not hum.Sit then
            continue
        end

        local seat = car:FindFirstChildWhichIsA("VehicleSeat", true)
        if not seat then
            continue
        end

        for _, snowman in pairs(snowFolder:GetChildren()) do
            if not snowman:IsA("Model") then
                continue
            end

            local breakable =
                snowman:FindFirstChild("Breakable")
                or snowman:FindFirstChild("BreakablePart")

            if not breakable or not breakable:IsA("BasePart") then
                continue
            end

            local startTime = tick()
            local attackDuration = 2

            while tick() - startTime < attackDuration and getfenv().AutoSmashSnow do
                local offset = 8

                local lookCF = CFrame.lookAt(
                    car.PrimaryPart.Position,
                    breakable.Position
                )

                local targetCF = CFrame.lookAt(
                    breakable.Position - lookCF.LookVector * offset,
                    breakable.Position
                )

                car:SetPrimaryPartCFrame(targetCF)

                task.wait(0.05)

                local speed = 150
                seat.AssemblyLinearVelocity =
                    seat.CFrame.LookVector * speed

                task.wait(0.35)
            end

            task.wait(2)
            break
        end
    end
end)

task.spawn(function()
    while true do
        task.wait(0.1)

        if not getfenv().AutoBronzeCup then
            continue
        end

        local bpFolder = workspace:FindFirstChild("BattlePassCollectables")
        if not bpFolder then continue end

        local cupsFolder = bpFolder:FindFirstChild("Bronze Cup")
        if not cupsFolder then continue end

        local root = getRoot()
        local hum = getHum()
        if hum.Sit then
            hum:ChangeState(Enum.HumanoidStateType.Jumping)
        end
        if not root or not hum then continue end

        for _, bronzecup in pairs(cupsFolder:GetChildren()) do
            if not bronzecup:IsA("Model") then continue end

            local cup = bronzecup:FindFirstChild("Bronze")
            if not cup or not cup:IsA("BasePart") then continue end

            while getfenv().AutoBronzeCup do
                if not cup.Parent or not bronzecup.Parent then
                    break
                end

                local randOffset = Vector3.new(
                    math.random(-6, 6),
                    0,
                    math.random(-6, 6)
                )

                root.CFrame = CFrame.new(cup.Position + randOffset)
                task.wait(0.15)

                hum:MoveTo(cup.Position)
                task.wait(0.4)
            end

            task.wait(0.1)
        end
    end
end)





Window:SelectTab(1)
SaveManager:IgnoreThemeSettings()

player.CharacterAdded:Connect(function(newChar)
    player.MaximumSimulationRadius = math.huge
    player.SimulationRadius = math.huge
	task.wait(1)
end)
